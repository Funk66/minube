{
	email admin@guirao.net
	admin :2019
	metrics {
		per_host
	}
	log {
		output file /var/log/caddy/server.log
	}
}

(proxy) {
	@blockedPaths {
		path *.php
		path */.git*
		path */.env*
		path */db.sqlite3*
		path */.htaccess*
	}
	abort @blockedPaths

	reverse_proxy {args[0]}:{args[1]}

	log {
		output file /var/log/caddy/{args[0]}.log
	}
}

photos.guirao.net {
	import proxy immich 2283
}

docs.guirao.net {
	import proxy paperless 8000
}

calendar.guirao.net {
	import proxy radicale 5232
}

mail.guirao.net {
	reverse_proxy stalwart:8080 {
		transport http {
			proxy_protocol v2
		}
	}

	log {
		output file /var/log/caddy/stalwart.log
	}
}

http://, https:// {
	abort
}
